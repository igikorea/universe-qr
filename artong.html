<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>유니에듀 앱 실행 중...</title>
    <script>
      const ua = navigator.userAgent.toLowerCase();
      const isAndroid = ua.includes("android");
      const isIOS = /iphone|ipad|ipod/.test(ua);

      // 앱 실행 링크
      const iosScheme = "uniedu://page/ar-tong";
      const androidIntent =
        "intent://page/ar-tong/#Intent;scheme=uniedu;package=com.igikorea.uni_edu;action=android.intent.action.VIEW;category=android.intent.category.BROWSABLE;S.browser_fallback_url=https://play.google.com/store/apps/details?id=com.igikorea.uni_edu;end";

      // 스토어 링크
      const appStoreURL =
        "itms-apps://itunes.apple.com/kr/app/%EC%9C%A0%EB%8B%88%EB%B2%84%EC%8A%A4/id6748672708";

      if (isAndroid) {
        window.location.replace(androidIntent);
      } else if (isIOS) {
          let movedToBackground = false;

                  const handleVisibility = () => {
                    if (document.hidden) movedToBackground = true;
                  };

                  document.addEventListener("visibilitychange", handleVisibility);
                  window.addEventListener("pagehide", handleVisibility);

                  // ✅ a 태그 클릭 기반 (Safari 17+ 대응)
                  const link = document.createElement("a");
                  link.href = iosScheme;
                  document.body.appendChild(link);
                  link.click();

                  // ✅ fallback: 앱 미설치 시 App Store로 이동
                  setTimeout(() => {
                    if (!movedToBackground) {
                      window.location.href = appStoreURL;
                    }
                  }, 2000);
      }
    </script>
  </head>
  <body>
    <h3>유니에듀 앱을 여는 중입니다...</h3>
  </body>
</html>
